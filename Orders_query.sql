CREATE DATABASE ONLINE_SALES;

USE ONLINE_SALES;

CREATE TABLE ORDERS
(
ORDER_ID VARCHAR (10) PRIMARY KEY,
ORDER_DATE DATE,
AMOUNT INT,
PRODUCT_ID VARCHAR (10)
);

SELECT * FROM ORDERS;

INSERT INTO ORDERS
VALUES
('ORD001', '2024-01-04', 950, 'P001'),
('ORD002', '2024-01-21', 760, 'P002'),
('ORD003', '2024-01-12', 1120, 'P003'),
('ORD004', '2024-01-30', 1340, 'P005'),
('ORD005', '2024-02-06', 980, 'P002'),
('ORD006', '2024-02-15', 1150, 'P004'),
('ORD007', '2024-02-22', 690, 'P006'),
('ORD008', '2024-02-28', 890, 'P001'),
('ORD009', '2024-03-14', 800, 'P003'),
('ORD010', '2024-03-03', 1020, 'P007'),
('ORD011', '2024-03-20', 930, 'P005'),
('ORD012', '2024-03-30', 1250, 'P002'),
('ORD013', '2024-04-01', 880, 'P006'),
('ORD014', '2024-04-09', 1070, 'P001'),
('ORD015', '2024-04-26', 950, 'P007'),
('ORD016', '2024-04-18', 720, 'P004'),
('ORD017', '2024-05-27', 750, 'P002'),
('ORD018', '2024-05-13', 880, 'P001'),
('ORD019', '2024-05-02', 1090, 'P003'),
('ORD020', '2024-05-19', 980, 'P005'),
('ORD021', '2024-06-04', 890, 'P004'),
('ORD022', '2024-06-11', 1040, 'P006'),
('ORD023', '2024-06-18', 970, 'P007'),
('ORD024', '2024-06-30', 860, 'P001'),
('ORD025', '2024-06-25', 990, 'P008'),
('ORD026', '2024-07-20', 790, 'P004'),
('ORD027', '2024-07-05', 1150, 'P002'),
('ORD028', '2024-07-28', 1030, 'P005'),
('ORD029', '2024-07-12', 940, 'P003'),
('ORD030', '2024-08-29', 890, 'P004'),
('ORD031', '2024-08-03', 870, 'P006'),
('ORD032', '2024-08-10', 980, 'P007'),
('ORD033', '2024-08-22', 960, 'P001'),
('ORD034', '2024-09-06', 920, 'P003'),
('ORD035', '2024-09-15', 1100, 'P002'),
('ORD036', '2024-09-30', 1010, 'P005'),
('ORD037', '2024-09-21', 840, 'P006'),
('ORD038', '2024-10-13', 1080, 'P004'),
('ORD039', '2024-10-18', 870, 'P009'),
('ORD040', '2024-10-05', 950, 'P001'),
('ORD041', '2024-10-24', 890, 'P007'),
('ORD042', '2024-11-14', 990, 'P006'),
('ORD043', '2024-11-21', 870, 'P002'),
('ORD044', '2024-11-02', 1130, 'P003'),
('ORD045', '2024-11-30', 1040, 'P001'),
('ORD046', '2024-12-03', 980, 'P004'),
('ORD047', '2024-12-11', 1060, 'P005'),
('ORD048', '2024-12-18', 930, 'P007'),
('ORD049', '2024-12-30', 890, 'P003'),
('ORD050', '2024-12-24', 1200, 'P002');

SELECT SUM(AMOUNT) AS 'MONTHLY_REVENUE', COUNT(DISTINCT ORDER_ID) AS ORDER_VOLUME, DATENAME (MONTH, ORDER_DATE) AS 'ORDER_MONTH'
FROM ORDERS
GROUP BY DATENAME (MONTH, ORDER_DATE)
HAVING SUM (AMOUNT) BETWEEN 3800 AND 5000
ORDER BY SUM(AMOUNT) DESC;